<!DOCTYPE html>
<html>
  <head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Papaya HUANG</title>
  <!-- add alifont -->

  <link
    rel="stylesheet"
    type="text/css"
    href="https://at.alicdn.com/t/c/font_2719161_qrg05vxlp7.css"
  />
  <!-- add style -->
  
<link rel="stylesheet" href="/css/style.css">

  <!-- add font-->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@100&display=swap"
    rel="stylesheet"
  />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,600;1,300;1,400&display=swap"
    rel="stylesheet"
  />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@200;300;400;500;600&display=swap"
    rel="stylesheet"
  />
<meta name="generator" content="Hexo 5.4.0"><link rel="stylesheet" href="/css/prism.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>


  <body>
    <header>
  <ul class="navbar">
    <li>
      <a href="/">
        <i class="icon iconfont icon-xuanzhongshangcheng"></i>
      </a>
    </li>
    <li>
      <a href="/about">
        <i class="icon iconfont icon-about"></i>
      </a>
    </li>
    <li>
      <a href="/projects">
        <i class="icon iconfont icon-project"></i>
      </a>
    </li>
    <li>
      <a href="/categories">
        <i class="icon iconfont icon-case-file-full"></i>
      </a>
    </li>
    <li>
      <a href="/archives">
        <i class="icon iconfont icon-Artboard2"></i>
      </a>
    </li>
  </ul>
</header>

    <aside>
  <div class="menu">
    

    <a class="menu-item" href="/">Home</a>

    

    <a class="menu-item" href="/about">About</a>

    

    <a class="menu-item" href="/projects">Projects</a>

    

    <a class="menu-item" href="/categories">Categories</a>

    

    <a class="menu-item" href="/archives">Archives</a>

    
  
  </div>
</aside>


    <div class="main"><div class="blog-post">
  
  <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E7%9B%AE%E7%9A%84"><span class="toc-text">项目目的</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E6%95%88%E6%9E%9C"><span class="toc-text">项目效果</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E5%AE%9E%E7%8E%B0%E6%AD%A5%E9%AA%A4"><span class="toc-text">项目实现步骤</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%95%E8%AF%AD%E7%9A%84%E5%BC%95%E7%94%A8"><span class="toc-text">引语的引用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%9C%E8%89%B2%E7%9A%84%E5%BC%95%E7%94%A8"><span class="toc-text">颜色的引用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9A%8F%E6%9C%BA%E6%8A%93%E5%8F%96%E5%BC%95%E8%A8%80"><span class="toc-text">随机抓取引言</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9A%8F%E6%9C%BA%E6%8A%93%E5%8F%96%E9%A2%9C%E8%89%B2"><span class="toc-text">随机抓取颜色</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%91%E5%AE%9A%E6%8C%89%E9%92%AE"><span class="toc-text">绑定按钮</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E5%9C%B0%E5%9D%80"><span class="toc-text">项目地址</span></a></li></ol>
  <div class='blog-main'>

    <!-- title -->
    <h2 class="blog-post-title">
      <a href="/2021/09/07/random-quote-machine/">
        项目练习 —— Random Quote Machine
      </a>
    </h2>
  
    <!-- date and author -->
    <p class="blog-post-meta">
      2021-09-07 
    </p>
  
  
    <!-- content -->
    <div class="post-content">
      <h2 id="项目目的"><a href="#项目目的" class="headerlink" title="项目目的"></a>项目目的</h2><p>这是FCC的一个项目，我一开始hardcode了一个版本，后来因为学习了React，所以利用<code>useState()</code>和<code>useEffect()</code>两个React Hook重新把这个项目写了一遍。</p>
<h2 id="项目效果"><a href="#项目效果" class="headerlink" title="项目效果"></a>项目效果</h2><p><img src="https://raw.githubusercontent.com/PapayaHUANG/images/main/img/20210908213859.png" alt="项目效果图"><br>如图所示，该项目需要实现：</p>
<ul>
<li>引用外部链接引语API</li>
<li>引语的句子和作者分别显示</li>
<li>点击new quote按钮即可引用新的引语</li>
<li>点击new quote按钮除了引文背景的白色不变，其他颜色同一随机替换成另一种颜色</li>
</ul>
<h2 id="项目实现步骤"><a href="#项目实现步骤" class="headerlink" title="项目实现步骤"></a>项目实现步骤</h2><p>这个项目需要引用两个方面的内容， <em>一个是引语API，一个是颜色数组</em>。</p>
<h3 id="引语的引用"><a href="#引语的引用" class="headerlink" title="引语的引用"></a>引语的引用</h3><p>引语的引语需要在页面渲染的时候就引用好，这里我们要使用<code>useEffect()</code>这个钩子,<code>useEffect()</code>一般的使用场景也是向服务器请求数据。<a target="_blank" rel="noopener" href="https://reactjs.org/docs/hooks-effect.html">官方文档</a>。<br><code>useEffect()</code>的使用如下：</p>
<pre class="line-numbers language-javascript"><code class="language-javascript">  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//Async Action</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">[</span>dependencies<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><code>useEffect()</code>接受两个参数。<br>第一参数是一个<em>函数</em>；第二个参数是一个<em>数组</em>，是Effect的依赖项，只要数组里的条件发生变化，<code>useEffect()</code>就会执行。第二个参数可以省略，这时每次组件渲染时，就会执行<code>useEffect()</code>。</p>
<p>而在Random Quote Machine这个项目中，我需要在组件首次渲染时，就获取引文数组信息，但是仅此获取一次，这就需要我们把第二个参数设定为<strong>空数组</strong>：</p>
<pre class="line-numbers language-javascript"><code class="language-javascript">  <span class="token keyword">const</span> url <span class="token operator">=</span><span class="token string">'quotesurl'</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> getData <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">setQuotes</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 获取url信息</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
      <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//页面首次渲染执行获取url函数一次</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>注意在<code>getData</code>函数内部，有一个<code>setQuotes(data)</code>,这里是我们使用了<code>useState()</code>,组件的初始状态是空数组。</p>
<h3 id="颜色的引用"><a href="#颜色的引用" class="headerlink" title="颜色的引用"></a>颜色的引用</h3><p>由于我一种只使用了12种颜色，所以颜色我是创建了color.js文件，在里面穷举了颜色：</p>
<pre class="line-numbers language-javascript"><code class="language-javascript">  <span class="token keyword">export</span> <span class="token keyword">const</span> Color <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">'#16a085'</span><span class="token punctuation">,</span>
    <span class="token string">'#27ae60'</span><span class="token punctuation">,</span>
    <span class="token string">'#2c3e50'</span><span class="token punctuation">,</span>
    <span class="token string">'#f39c12'</span><span class="token punctuation">,</span>
    <span class="token string">'#e74c3c'</span><span class="token punctuation">,</span>
    <span class="token string">'#9b59b6'</span><span class="token punctuation">,</span>
    <span class="token string">'#FB6964'</span><span class="token punctuation">,</span>
    <span class="token string">'#342224'</span><span class="token punctuation">,</span>
    <span class="token string">'#472E32'</span><span class="token punctuation">,</span>
    <span class="token string">'#BDBB99'</span><span class="token punctuation">,</span>
    <span class="token string">'#77B1A9'</span><span class="token punctuation">,</span>
    <span class="token string">'#73A857'</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="随机抓取引言"><a href="#随机抓取引言" class="headerlink" title="随机抓取引言"></a>随机抓取引言</h3><p>在抓取引言的时候，有一个小细节需要注意，官方给的<a target="_blank" rel="noopener" href="https://gist.githubusercontent.com/camperbot/5a022b72e96c4c9585c32bf6a75f62d9/raw/e3c6895ce42069f0ee7e991229064f167fe8ccdc/quotes.json">API</a>有一个总<code>&quot;quotes&quot;:[...]</code>,所以即便用<code>props</code>把上层组件引用属性传下来了，也不能直接使用，需要引用引语 下一层级的<code>quote</code>：</p>
<pre class="line-numbers language-javascript"><code class="language-javascript">  <span class="token keyword">const</span> <span class="token punctuation">{</span> quotes <span class="token punctuation">}</span> <span class="token operator">=</span> props<span class="token punctuation">.</span>quotes<span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>随机引用的方法是<code>useState()</code>随机生成一个<code>index</code>：</p>
<pre class="line-numbers language-javascript"><code class="language-javascript">  <span class="token keyword">const</span> <span class="token punctuation">[</span>index<span class="token punctuation">,</span> setIndex<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//初始值设定为0</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>这样就可以利用javascript自带的<code>Math()</code>对象来处理：</p>
<pre class="line-numbers language-javascript"><code class="language-javascript">  <span class="token keyword">if</span> <span class="token punctuation">(</span>quotes<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> newIndex <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> quotes<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setIndex</span><span class="token punctuation">(</span>newIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="随机抓取颜色"><a href="#随机抓取颜色" class="headerlink" title="随机抓取颜色"></a>随机抓取颜色</h3><p>颜色的引用可以直接用<code>import &#123; Color &#125; from &#39;./color&#39;</code>,再采用引言相同的方法，生成随机的<code>colorIndex</code>。</p>
<h3 id="绑定按钮"><a href="#绑定按钮" class="headerlink" title="绑定按钮"></a>绑定按钮</h3><p>把随机生成的引言和颜色写进一个函数内：</p>
<pre class="line-numbers language-javascript"><code class="language-javascript">  <span class="token keyword">const</span> clickHandlder <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> colorIndex <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> Color<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> randomColor <span class="token operator">=</span> Color<span class="token punctuation">[</span>colorIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
    
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> colorElements<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        colorElements<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>randomColor<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> bkColorElements<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        bkColorElements<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>backgroundColor <span class="token operator">=</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>randomColor<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>quotes<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> newIndex <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> quotes<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setIndex</span><span class="token punctuation">(</span>newIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>然后绑定到按钮：</p>
<pre class="line-numbers language-javascript"><code class="language-javascript">  <span class="token operator">&lt;</span>button className<span class="token operator">=</span><span class="token string">"btn bkColor"</span> 
  onClick<span class="token operator">=</span><span class="token punctuation">{</span>clickHandlder<span class="token punctuation">}</span><span class="token operator">></span>
     <span class="token keyword">new</span> <span class="token class-name">quote</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="项目地址"><a href="#项目地址" class="headerlink" title="项目地址"></a>项目地址</h2><p><a target="_blank" rel="noopener" href="https://github.com/PapayaHUANG/randomquote_machine">https://github.com/PapayaHUANG/randomquote_machine</a></p>

    </div>
  
    <hr>
    
    
       <!-- categories -->
    
       
    <span class="post-categories">
      <i class='icon iconfont icon-icon-goodscategory'></i>
      <a href="/categories/项目练习/">项目练习</a>
    </span>
    
    
       <!-- tag -->
     
    
    <span class="post-tags">
      <i class="icon iconfont icon-tag"></i>
      <a href="/tags/react/">react</a>
    </span>
    
  </div>
</div>


</div>
  
  </body>
</html>

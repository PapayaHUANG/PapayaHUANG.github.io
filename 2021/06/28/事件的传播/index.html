<!DOCTYPE html>
<html>
  <head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Papaya HUANG</title>
  <!-- add alifont -->

  <link
    rel="stylesheet"
    type="text/css"
    href="https://at.alicdn.com/t/c/font_2719161_qrg05vxlp7.css"
  />
  <!-- add style -->
  
<link rel="stylesheet" href="/css/style.css">

  <!-- add font-->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@100&display=swap"
    rel="stylesheet"
  />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,600;1,300;1,400&display=swap"
    rel="stylesheet"
  />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@200;300;400;500;600&display=swap"
    rel="stylesheet"
  />
<meta name="generator" content="Hexo 5.4.0"><link rel="stylesheet" href="/css/prism.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>


  <body>
    <header>
  <ul class="navbar">
    <li>
      <a href="/">
        <i class="icon iconfont icon-xuanzhongshangcheng"></i>
      </a>
    </li>
    <li>
      <a href="/about">
        <i class="icon iconfont icon-about"></i>
      </a>
    </li>
    <li>
      <a href="/projects">
        <i class="icon iconfont icon-project"></i>
      </a>
    </li>
    <li>
      <a href="/categories">
        <i class="icon iconfont icon-case-file-full"></i>
      </a>
    </li>
    <li>
      <a href="/archives">
        <i class="icon iconfont icon-Artboard2"></i>
      </a>
    </li>
  </ul>
</header>

    <aside>
  <div class="menu">
    

    <a class="menu-item" href="/">Home</a>

    

    <a class="menu-item" href="/about">About</a>

    

    <a class="menu-item" href="/projects">Projects</a>

    

    <a class="menu-item" href="/categories">Categories</a>

    

    <a class="menu-item" href="/archives">Archives</a>

    
  
  </div>
</aside>


    <div class="main"><div class="blog-post">
  
  <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E4%BA%8B%E4%BB%B6%E7%9A%84%E4%BC%A0%E6%92%AD%EF%BC%88Event-Propagation"><span class="toc-text">什么是事件的传播（Event Propagation)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E9%98%B6%E6%AE%B5"><span class="toc-text">第一阶段</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E9%98%B6%E6%AE%B5"><span class="toc-text">第二阶段</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E9%98%B6%E6%AE%B5"><span class="toc-text">第三阶段</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E7%9F%A5%E9%81%93%E4%BA%8B%E4%BB%B6%E5%A4%84%E4%BA%8E%E4%BB%80%E4%B9%88%E9%98%B6%E6%AE%B5%EF%BC%9F"><span class="toc-text">如何知道事件处于什么阶段？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E8%8E%B7%E5%8F%96%E4%BA%8B%E4%BB%B6%E7%9A%84%E6%8D%95%E8%8E%B7%E9%98%B6%E6%AE%B5-%E5%86%92%E6%B3%A1%E9%98%B6%E6%AE%B5"><span class="toc-text">如何获取事件的捕获阶段&#x2F;冒泡阶段</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#e-target%E5%92%8Cthis%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-text">e.target和this的区别</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E5%81%9C%E6%AD%A2%E4%BA%8B%E4%BB%B6%E4%BC%A0%E6%92%AD"><span class="toc-text">如何停止事件传播</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E4%BC%A0%E6%92%AD%E5%9C%A8%E5%AE%9E%E9%99%85%E6%83%85%E5%86%B5%E4%B8%AD%E7%9A%84%E8%BF%90%E7%94%A8"><span class="toc-text">事件传播在实际情况中的运用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="toc-text">参考资料</span></a></li></ol>
  <div class='blog-main'>

    <!-- title -->
    <h2 class="blog-post-title">
      <a href="/2021/06/28/事件的传播/">
        DOM Event Propagation事件的传播
      </a>
    </h2>
  
    <!-- date and author -->
    <p class="blog-post-meta">
      2021-06-28 
    </p>
  
  
    <!-- content -->
    <div class="post-content">
      <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>最近在做项目练习的时候碰到了<code>prevent.default()</code>这个方法，在搜索资料的时候发现这个和<strong>event的事件流</strong>有关，所以就借此机会把整个事件传播的基础概念梳理了一遍。</p>
<h2 id="什么是事件的传播（Event-Propagation"><a href="#什么是事件的传播（Event-Propagation" class="headerlink" title="什么是事件的传播（Event Propagation)"></a>什么是事件的传播（Event Propagation)</h2><p>一个事件发生之后，会在子元素和父元素之间传播。<br>这种传播分为三个阶段。</p>
<h3 id="第一阶段"><a href="#第一阶段" class="headerlink" title="第一阶段"></a>第一阶段</h3><p><strong>Capture Phase 捕获阶段</strong></p>
<p>从window对象传导到目标节点（上层传到底层）；</p>
<h3 id="第二阶段"><a href="#第二阶段" class="headerlink" title="第二阶段"></a>第二阶段</h3><p><strong>Target Phase 目标阶段</strong></p>
<p>在目标节点上触发；</p>
<h3 id="第三阶段"><a href="#第三阶段" class="headerlink" title="第三阶段"></a>第三阶段</h3><p><strong>Bubbling Phase 冒泡阶段</strong></p>
<p>从目标节点传导回window对象（从底层传回上层）。</p>
<p><img src="https://raw.githubusercontent.com/PapayaHUANG/images/main/img/%E4%BA%8B%E4%BB%B6%E4%BC%A0%E6%92%AD.png" alt="事件传播"></p>
<h2 id="如何知道事件处于什么阶段？"><a href="#如何知道事件处于什么阶段？" class="headerlink" title="如何知道事件处于什么阶段？"></a>如何知道事件处于什么阶段？</h2><p>可以使用方法<code>event.eventPhase()</code>来获取：</p>
<p>1 = capturing</p>
<p>2 = target</p>
<p>3 = bubbling</p>
<p>0 = none</p>
<h2 id="如何获取事件的捕获阶段-冒泡阶段"><a href="#如何获取事件的捕获阶段-冒泡阶段" class="headerlink" title="如何获取事件的捕获阶段/冒泡阶段"></a>如何获取事件的捕获阶段/冒泡阶段</h2><p>这里涉及到<code>addEventListener()</code>的三个参数中的最后一个参数<code>（useCaputre）</code></p>
<p>如果该值为默认值即’false’，则获取的是由底层到上层的<em>冒泡阶段</em>；</p>
<p>如果该值为’true’，则获取的是由上层到底层的<em>捕获阶段</em>。</p>
<p>同时，每次事件目标即target，这也是为什么我们会在编写代码中经常使用<code>e.target</code>来指向事件绑定目标。</p>
<h3 id="e-target和this的区别"><a href="#e-target和this的区别" class="headerlink" title="e.target和this的区别"></a>e.target和this的区别</h3><p><code>this</code>指在嵌套的各个元素中是动态的，指向事件流过程中的每一个节点，而<code>e.target</code>仅指事件发生的这个特定元素。</p>
<h2 id="如何停止事件传播"><a href="#如何停止事件传播" class="headerlink" title="如何停止事件传播"></a>如何停止事件传播</h2><p>可以使用<code>event.stopPropagation()</code>这个方法，</p>
<pre class="line-numbers language-javascript"><code class="language-javascript">   <span class="token keyword">var</span> ul <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'ul'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   ul<span class="token punctuation">.</span><span class="token function">addEvenListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">{</span>
       <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>tagName<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'li'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          <span class="token comment" spellcheck="true">// some code here</span>
       <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="事件传播在实际情况中的运用"><a href="#事件传播在实际情况中的运用" class="headerlink" title="事件传播在实际情况中的运用"></a>事件传播在实际情况中的运用</h2><p>事件委托/代理（delegation）</p>
<p>即不在事件的发生地（直接DOM）上设置监听函数，而是在其父元素上设置监听函数。</p>
<p>这是由于事件会在冒泡阶段向上传播到父节点，由父节点的监听函数统一处理多个子元素事件。</p>
<pre class="line-numbers language-javascript"><code class="language-javascript">   <span class="token keyword">var</span> ul <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'ul'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   ul<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>tagName<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'li'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// some code</span>
       <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>上面就是把click事件直接绑定到了<code>ul</code>，这样做的<strong>好处</strong>是，只要定义一个监听函数，就能处理多个子节点的事件。<br>即<em>1.减少内存消耗；2.动态绑定事件</em>。</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=BtOrr7oTH_8&list=RDCMUC07WzVtVDVksJR30sU7-EWg&index=1">Event Propagation Explained- Youtube - Zac Gordon</a></p>
<p><a target="_blank" rel="noopener" href="https://wangdoc.com/javascript/events/model.html#%E4%BA%8B%E4%BB%B6%E7%9A%84%E4%BC%A0%E6%92%AD">事件的传播 - 网道 - JavaScript教程</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/26536815">JS事件委托详解 - 知乎 - 桐城</a></p>

    </div>
  
    <hr>
    
    
       <!-- categories -->
    
       
    <span class="post-categories">
      <i class='icon iconfont icon-icon-goodscategory'></i>
      <a href="/categories/基础知识盘点/">基础知识盘点</a>
    </span>
    
    
       <!-- tag -->
     
    
    <span class="post-tags">
      <i class="icon iconfont icon-tag"></i>
      <a href="/tags/js/">js</a>
    </span>
    
  </div>
</div>


</div>
  
  </body>
</html>
